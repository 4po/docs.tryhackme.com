(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{154:function(e,n,t){"use strict";t.r(n),t.d(n,"frontMatter",(function(){return s})),t.d(n,"metadata",(function(){return a})),t.d(n,"rightToc",(function(){return c})),t.d(n,"default",(function(){return p}));var o=t(1),r=t(9),i=(t(0),t(171)),s={id:"openvpn-troubleshooting",title:"OpenVPN Troubleshooting",sidebar_label:"OpenVPN Troubleshooting"},a={id:"openvpn/troubleshooting/openvpn-troubleshooting",title:"OpenVPN Troubleshooting",description:"## No Connectivity",source:"@site/docs/openvpn/troubleshooting/troubleshooting.md",permalink:"/docs/openvpn/troubleshooting/openvpn-troubleshooting",editUrl:"https://github.com/tryhackmeltd/docs.tryhackme.com/edit/master/docs/openvpn/troubleshooting/troubleshooting.md",lastUpdatedBy:"James",lastUpdatedAt:1588171658,sidebar_label:"OpenVPN Troubleshooting",sidebar:"docs",previous:{title:"Connecting With OpenVPN",permalink:"/docs/openvpn/connecting/openvpn-connecting"},next:{title:"What are Rooms",permalink:"/docs/rooms/what-are-rooms"}},c=[{value:"No Connectivity",id:"no-connectivity",children:[{value:"Resolving on Linux:",id:"resolving-on-linux",children:[]},{value:"Resolving on Windows",id:"resolving-on-windows",children:[]}]},{value:"Not receiving reverse shells or Metasploit exploits not creating sessions",id:"not-receiving-reverse-shells-or-metasploit-exploits-not-creating-sessions",children:[]},{value:"Intermittent Connection (Random Drop-outs):",id:"intermittent-connection-random-drop-outs",children:[{value:"Checking for External Issuses:",id:"checking-for-external-issuses",children:[]},{value:"Checking for OpenVPN Issues:",id:"checking-for-openvpn-issues",children:[]}]}],l={rightToc:c};function p(e){var n=e.components,t=Object(r.a)(e,["components"]);return Object(i.b)("wrapper",Object(o.a)({},l,t,{components:n,mdxType:"MDXLayout"}),Object(i.b)("h2",{id:"no-connectivity"},"No Connectivity"),Object(i.b)("p",null,"This is most likely due to lack of permissions. For example, running OpenVPN on Linux without ",Object(i.b)("inlineCode",{parentName:"p"},"sudo"),"."),Object(i.b)("h3",{id:"resolving-on-linux"},"Resolving on Linux:"),Object(i.b)("p",null,"To resolve, perform the following:"),Object(i.b)("ol",null,Object(i.b)("li",{parentName:"ol"},Object(i.b)("p",{parentName:"li"},"Ensure there is no OpenVPN process running by launching a terminal and entering: ",Object(i.b)("br",null),"\n",Object(i.b)("inlineCode",{parentName:"p"},"sudo killall openvpn"))),Object(i.b)("li",{parentName:"ol"},Object(i.b)("p",{parentName:"li"},"Then launch OpenVPN with administrative permissions,     ",Object(i.b)("inlineCode",{parentName:"p"},"sudo openvpn <path to config>")))),Object(i.b)("p",null,"If you find yourself still unable to connect to the TryHackMe network, you will need to recreate your ",Object(i.b)("strong",{parentName:"p"},Object(i.b)("a",Object(o.a)({parentName:"strong"},{href:"https://tryhacke.com/access"}),"OpenVPN Configuration file")),", by pressing the ",Object(i.b)("strong",{parentName:"p"},'"Regenerate"')," button like in the photo below."),Object(i.b)("p",null,Object(i.b)("img",Object(o.a)({parentName:"p"},{src:"https://i.imgur.com/jCnkADu.png",alt:"Regen OpenVPN File"}))),Object(i.b)("p",null,"After allowing the process to complete, you will now need to redownload this configuration file and connect via the steps outlined in the ",Object(i.b)("strong",{parentName:"p"},Object(i.b)("a",Object(o.a)({parentName:"strong"},{href:"http://localhost:3000/docs/openvpn/connecting/openvpn-connecting"}),"OpenVPN Connection Guide"))),Object(i.b)("p",null,"Even after this you still cannot connect, please get in touch with support."),Object(i.b)("h3",{id:"resolving-on-windows"},"Resolving on Windows"),Object(i.b)("p",null,"We have noticed reports of difficulty connecting to the TryHackMe network using OpenVPN on Windows. For example, some users haven't been able to use Zenmap/Nmap against deployed instances whilst being shown as connected."),Object(i.b)("p",null,"As a good rule of thumb, the only need to connect to the TryHackMe network is to use tools against instances that are often not supported on Windows. I.e. ",Object(i.b)("inlineCode",{parentName:"p"},"netcat")," reverse shells. Moreover, WSL even though it is ",Object(i.b)("em",{parentName:"p"},"Linux"),", launching OpenVPN as if it were will not work. We encourage the use of Linux as much as possible for compatibility."),Object(i.b)("ol",null,Object(i.b)("li",{parentName:"ol"},"Revisit the ",Object(i.b)("a",Object(o.a)({parentName:"li"},{href:"http://localhost:3000/docs/openvpn/connecting/openvpn-connecting#connecting-via-windows"}),"OpenVPN Connection Guide for Windows")," and ensure you are running as an administrator.")),Object(i.b)("h2",{id:"not-receiving-reverse-shells-or-metasploit-exploits-not-creating-sessions"},"Not receiving reverse shells or Metasploit exploits not creating sessions"),Object(i.b)("p",null,"This is normally either incorrect exploit settings (check this first!) or people using a kali VM but running the VPN connection on their host machine.\nThe reverse shell will try and connect to the IP address, but that IP address points to the host rather than the VM so a connection will not be made."),Object(i.b)("h2",{id:"intermittent-connection-random-drop-outs"},"Intermittent Connection (Random Drop-outs):"),Object(i.b)("p",null,"This issue usually stems from multiple connections to the TryHackMe network. However, look for external factors to OpenVPN as to why you are experiencing issues first:"),Object(i.b)("h3",{id:"checking-for-external-issuses"},"Checking for External Issuses:"),Object(i.b)("ol",null,Object(i.b)("li",{parentName:"ol"},"In this setup, OpenVPN does not route all of your internet traffic through TryHackMe - are you able to connect to external websites like google?"),Object(i.b)("li",{parentName:"ol"},"Are you using WiFi? Perhaps there could be interference or distancing issues resulting in a weak signal that would disrupt connectivity."),Object(i.b)("li",{parentName:"ol"},"Are you in a country that blocks OpenVPN traffic? (China, Egypt)")),Object(i.b)("h3",{id:"checking-for-openvpn-issues"},"Checking for OpenVPN Issues:"),Object(i.b)("p",null,"Most errors relating to maintaining connectivity to TryHackMe, despite a good connection otherwsie stems from having multiple sessions (or connections) with OpenVPN."),Object(i.b)("p",null,"For a stable connection, ",Object(i.b)("strong",{parentName:"p"},"OpenVPN needs to be ran only once"),". Otherwise it will start disconnecting/connection between the various sessions. To resolve this, perform the following in a new terminal:"),Object(i.b)("ol",null,Object(i.b)("li",{parentName:"ol"},Object(i.b)("p",{parentName:"li"},"Type ",Object(i.b)("inlineCode",{parentName:"p"},"ps aux | grep openvpn")," into your ","[linux]"," terminal and press enter.")),Object(i.b)("li",{parentName:"ol"},Object(i.b)("p",{parentName:"li"},"If there's more than one and the ",Object(i.b)("strong",{parentName:"p"},'second entry doesn\'t have "grep" in it'),", perform the following steps:")),Object(i.b)("li",{parentName:"ol"},Object(i.b)("p",{parentName:"li"},"Type ",Object(i.b)("inlineCode",{parentName:"p"},"sudo killall openvpn")," into your ","[linux]"," terminal and press enter.")),Object(i.b)("li",{parentName:"ol"},Object(i.b)("p",{parentName:"li"},"Start the VPN with ",Object(i.b)("inlineCode",{parentName:"p"},"sudo openvpn <path-to-config>")))),Object(i.b)("p",null,'Please note these instructions were written prior to Kali 2020. For Kali 2020 onwards and other distros that do not use root user by default, you can expect another line starting with "sudo". This is not an openvpn process, it\'s a sudo process.'))}p.isMDXComponent=!0},171:function(e,n,t){"use strict";t.d(n,"a",(function(){return u})),t.d(n,"b",(function(){return d}));var o=t(0),r=t.n(o);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function s(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function a(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?s(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function c(e,n){if(null==e)return{};var t,o,r=function(e,n){if(null==e)return{};var t,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)t=i[o],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)t=i[o],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var l=r.a.createContext({}),p=function(e){var n=r.a.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):a({},n,{},e)),t},u=function(e){var n=p(e.components);return r.a.createElement(l.Provider,{value:n},e.children)},b={inlineCode:"code",wrapper:function(e){var n=e.children;return r.a.createElement(r.a.Fragment,{},n)}},h=Object(o.forwardRef)((function(e,n){var t=e.components,o=e.mdxType,i=e.originalType,s=e.parentName,l=c(e,["components","mdxType","originalType","parentName"]),u=p(t),h=o,d=u["".concat(s,".").concat(h)]||u[h]||b[h]||i;return t?r.a.createElement(d,a({ref:n},l,{components:t})):r.a.createElement(d,a({ref:n},l))}));function d(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var i=t.length,s=new Array(i);s[0]=h;var a={};for(var c in n)hasOwnProperty.call(n,c)&&(a[c]=n[c]);a.originalType=e,a.mdxType="string"==typeof e?e:o,s[1]=a;for(var l=2;l<i;l++)s[l]=t[l];return r.a.createElement.apply(null,s)}return r.a.createElement.apply(null,t)}h.displayName="MDXCreateElement"}}]);